<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" type="text/css" href="style.css">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes" />
<link rel="icon" type="image/x-icon" href="img/favicon.ico">
<title>Death Machine - Home</title>

<body>

   <div id="lightbox" class="lightbox" aria-hidden="true">
      <div class="lightbox-backdrop"></div>

      <div class="lightbox-content">
         <img id="lightbox-img" alt="" hidden>
         <video id="lightbox-video" controls hidden playsinline></video>
      </div>

      <div class="lightbox-hint">Click outside the image to close</div>

   </div>
   <div class="wrapper">
      <header>
         <img src="banner.png" alt="Death Machine" width="1200" height="125" />
         <nav>
            <a class="active" href="index.html">Home</a>
            <a href="news.html">News</a>
            <a href="tour.html">Tour</a>
            <a href="music.html">Music</a>
            <a href="store.html">Store</a>
         </nav>
      </header>
      <div class="content">
         <!--3 columns, responsive with flex, middle column is priority 1 when wrapping-->
         <div class="left">
            <a class="newsvert" href="store.html#newsletter"><img src="newsvert1.png"
                  alt="Enter to win a custom Death Machine guitar! - Black electric guitar with red vein design."
                  width="200" height="800" /></a>
         </div>
         <div class="middle">
            <br />
            <video style="width:565px; object-fit:contain;" autoplay muted loop playsinline>
               <source src="dm2021.webm" type="video/webm">
            </video>
            <div class="note">
               <span style="display:block; text-align:center;"><h2>NEWS</h2></span>
               <hr style="border:0; border-top:2px solid white; width:100%;">
               <br>
               <h4>Tour Canceled</h4>
               <div class="news-date">Posted: April 2021</div>
               <p class="news-text">
                  It is with a heavy heart that we must announce the cancellation of the 2021 tour. We are deeply
                  saddened by this, but the state of the world has forced us to accept the unfortunate reality
                  that it would be irresponsible to subject our fans to the very real threat of
                  being infected with COVID-19. Please accept our deepest apologies üíî
               </p>
            </div>
            <a href="tourcanceled.png" class="lightbox-trigger"><img src="tourcanceled.png" id="poster"
                  alt="2021 Tour Poster - Cancellation Notice" width="792" /></a>
            <br />
            <br />
            <h2></h2>
            <br />
         </div>
         <div class="right">
            <a class="newsvert" href="store.html"><img src="newsvert2.png"
                  alt="New 2021 Tour Merch! Click to go to store page." width="200" height="800" /></a>
         </div>
      </div>
      <footer>
         Copyright <a href="../index.html">Death Machine</a> 2022 &copy;
         <small>Fictional band website created as a school project. Not an actual band.</small>
      </footer>
   </div>
   <a href="https://nathanarcuri.com/projects.html#school"
      style="position:fixed;top:12px;left:12px;z-index:9999;padding:8px 14px;background:#111;color:#fff;border-radius:8px;text-decoration:none;font-weight:600;box-shadow:0 4px 12px rgba(0,0,0,.4);">‚Üê
      Projects</a>


   <script>
      (function () {
         const lightbox = document.getElementById("lightbox");
         const img = document.getElementById("lightbox-img");
         const video = document.getElementById("lightbox-video");
         const backdrop = lightbox ? lightbox.querySelector(".lightbox-backdrop") : null;

         if (!lightbox || !img || !video || !backdrop) return;

         function isVideoUrl(src) {
            try {
               const clean = src.split("#")[0].split("?")[0];
               return /\.(mp4|webm|ogg)$/i.test(clean);
            } catch {
               return false;
            }
         }

         function resetMedia() {
            img.hidden = true;
            img.src = "";

            video.hidden = true;
            video.pause();
            video.removeAttribute("src");
            video.load();
         }

         function openLightbox(src) {
            resetMedia();

            if (isVideoUrl(src)) {
               video.src = src;
               video.hidden = false;
               video.load();
               video.play().catch(() => { });
            } else {
               img.src = src;
               img.hidden = false;
            }

            lightbox.classList.add("is-open");
            lightbox.setAttribute("aria-hidden", "false");
         }

         function closeLightbox() {
            lightbox.classList.remove("is-open");
            lightbox.setAttribute("aria-hidden", "true");
            resetMedia();
         }

         document.addEventListener("click", e => {
            const trigger = e.target.closest(".lightbox-trigger");
            if (!trigger) return;

            const href = trigger.getAttribute("href");
            if (!href) return;

            e.preventDefault();
            openLightbox(href);
         });

         backdrop.addEventListener("click", closeLightbox);

         document.addEventListener("keydown", e => {
            if (e.key === "Escape" && lightbox.classList.contains("is-open")) {
               closeLightbox();
            }
         });
      })();
   </script>

</body>

</html>